<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Add The USD (Solana) — One-Click</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Helvetica,Arial,sans-serif;background:#0b1020;color:#e6e8ef;display:flex;min-height:100vh;align-items:center;justify-content:center;margin:0}
    .card{background:#121732;border:1px solid #2a2f4a;border-radius:18px;padding:28px;max-width:720px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{font-size:22px;margin:0 0 12px}
    p{opacity:.9;line-height:1.5;margin:10px 0}
    .row{display:flex;gap:14px;align-items:center;margin:14px 0 22px}
    .logo{width:48px;height:48px;border-radius:12px;border:1px solid #2a2f4a;object-fit:cover}
    code{background:#0b0f24;border:1px solid #263056;border-radius:10px;padding:6px 8px}
    .btn{cursor:pointer;border:1px solid #44d19e;background:#19c37d;color:#08131a;padding:12px 16px;border-radius:12px;font-weight:700}
    .btn:active{transform:translateY(1px)}
    .muted{opacity:.7}
    .stack{display:flex;gap:10px;flex-wrap:wrap}
    a.btn{display:inline-block;text-decoration:none}
    .warn{background:#271a00;color:#ffd27a;border:1px solid #6b4e00;border-radius:12px;padding:10px 12px;margin-top:14px}
    .ok{background:#0e2a1a;color:#b9ffd8;border:1px solid #1d6b49;border-radius:12px;padding:10px 12px;margin-top:14px}
  </style>
</head>
<body>
  <div class="card">
    <h1>➕ Add <b>The USD</b> (Solana)</h1>

    <div class="row">
      <img class="logo" src="https://ipfs.io/ipfs/QmUmhPL1ramHL3pNYqhBKknzwGvekNeTTXUtmyRNjsruQo" alt="token" />
      <div>
        <div><span class="muted">Address:</span> <code>DScwRVryd7ZjMGZFVpUR3i48bviJxnWDkxKGhV6cfsjf</code></div>
        <div><span class="muted">Symbol:</span> <code>U S D T</code> &nbsp; <span class="muted">Decimals:</span> <code>6</code></div>
      </div>
    </div>

    <div class="stack">
      <button id="connectBtn" class="btn" style="background:#4aa3ff;border-color:#88bfff;color:#06152b">Connect Wallet</button>
      <button id="addTokenBtn" class="btn">Add to Phantom</button>
      <a class="btn" id="mobileLink" target="_blank" rel="noopener">Open in Phantom (mobile)</a>
    </div>

    <p class="muted">
      Works on desktop wallets and Phantom mobile. If prompted, it will switch to <b>Solana</b>.
    </p>
    <p class="warn" id="mobileTip" style="display:none">
      Tip: On phones, open this page inside the <b>Phantom</b> in-app browser (Browser tab), then tap <b>Add to Phantom</b>.
    </p>

    <div id="status" class="ok" style="display:none"></div>
  </div>

  <script>
    const TOKEN = {
      address: "DScwRVryd7ZjMGZFVpUR3i48bviJxnWDkxKGhV6cfsjf",
      symbol: "U S D T",
      decimals: 6,
      image: "https://ipfs.io/ipfs/QmUmhPL1ramHL3pNYqhBKknzwGvekNeTTXUtmyRNjsruQo"
    };

    const SOLANA = {
      chainId: "0x1", // Mainnet Solana
      chainName: "Solana",
      nativeCurrency: { name: "SOL", symbol: "SOL", decimals: 9 },
      rpcUrls: ["https://api.mainnet-beta.solana.com"],
      blockExplorerUrls: ["https://explorer.solana.com"]
    };

    const solana = window.solana;
    const st = (msg) => {
      const el = document.getElementById("status");
      el.textContent = msg;
      el.style.display = "block";
      console.log("[STATUS]", msg);
    };

    if (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
      document.getElementById("mobileTip").style.display = "block";
    }

    async function ensureSolana() {
      const current = await solana.request({ method: "solana_chainId" });
      if (current !== SOLANA.chainId) {
        try {
          await solana.request({ method: "wallet_switchSolanaChain", params: [{ chainId: SOLANA.chainId }] });
        } catch (err) {
          if (err && err.code === 4902) {
            await solana.request({ method: "wallet_addSolanaChain", params: [SOLANA] });
          } else {
            throw err;
          }
        }
      }
    }

    async function connect() {
      if (!solana) return st("No wallet detected. Open in Phantom mobile or install Phantom.");
      try {
        const accounts = await solana.request({ method: "solana_requestAccounts" });
        st("Connected: " + accounts[0]);
      } catch {
        st("User rejected connection or an error occurred.");
      }
    }

    async function addToken() {
      if (!solana) return st("No wallet detected. Open in Phantom mobile or install Phantom.");
      try {
        await ensureSolana();
        const added = await solana.request({
          method: "wallet_watchAsset",
          params: { type: "SOL", options: TOKEN }
        });
        st(added ? "The USD added to your wallet ✅" : "User dismissed the add-token prompt.");
      } catch (e) {
        st(e?.message || "Failed to add token");
      }
    }

    document.getElementById("connectBtn").addEventListener("click", connect);
    document.getElementById("addTokenBtn").addEventListener("click", addToken);

    const params = new URLSearchParams({
      address: TOKEN.address,
      symbol: TOKEN.symbol,
      decimals: String(TOKEN.decimals),
      chainId: "1"
    });
    document.getElementById("mobileLink").href =
      "https://phantom.app/add-token?" + params.toString();
  </script>
</body>
</html>
